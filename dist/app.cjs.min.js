"use strict";function _createForOfIteratorHelper(e,t){var r,n,a,o,i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return n=!(r=!0),{s:function(){i=i.call(e)},n:function(){var e=i.next();return r=e.done,e},e:function(e){n=!0,a=e},f:function(){try{r||null==i.return||i.return()}finally{if(n)throw a}}};if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return i&&(e=i),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ownKeys(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,s=[],c=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var global$1=void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},global=void 0!==global$1?global$1:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},freeGlobal="object"==_typeof(global)&&global&&global.Object===Object&&global,freeSelf="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),_Symbol=root.Symbol,objectProto$e=Object.prototype,hasOwnProperty$b=objectProto$e.hasOwnProperty,nativeObjectToString$1=objectProto$e.toString,symToStringTag$1=_Symbol?_Symbol.toStringTag:void 0;function getRawTag(e){var t=hasOwnProperty$b.call(e,symToStringTag$1),r=e[symToStringTag$1];try{var n=!(e[symToStringTag$1]=void 0)}catch(e){}var a=nativeObjectToString$1.call(e);return n&&(t?e[symToStringTag$1]=r:delete e[symToStringTag$1]),a}var objectProto$d=Object.prototype,nativeObjectToString=objectProto$d.toString;function objectToString(e){return nativeObjectToString.call(e)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=_Symbol?_Symbol.toStringTag:void 0;function baseGetTag(e){return null==e?void 0===e?undefinedTag:nullTag:(symToStringTag&&symToStringTag in Object(e)?getRawTag:objectToString)(e)}function isObjectLike(e){return null!=e&&"object"==_typeof(e)}var symbolTag$1="[object Symbol]";function isSymbol(e){return"symbol"==_typeof(e)||isObjectLike(e)&&baseGetTag(e)==symbolTag$1}function arrayMap(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var isArray=Array.isArray,INFINITY$2=1/0,symbolProto$1=_Symbol?_Symbol.prototype:void 0,symbolToString=symbolProto$1?symbolProto$1.toString:void 0;function baseToString(e){var t;return"string"==typeof e?e:isArray(e)?arrayMap(e,baseToString)+"":isSymbol(e)?symbolToString?symbolToString.call(e):"":"0"==(t=e+"")&&1/e==-INFINITY$2?"-0":t}var reWhitespace=/\s/;function trimmedEndIndex(e){for(var t=e.length;t--&&reWhitespace.test(e.charAt(t)););return t}var reTrimStart=/^\s+/;function baseTrim(e){return e&&e.slice(0,trimmedEndIndex(e)+1).replace(reTrimStart,"")}function isObject(e){var t=_typeof(e);return null!=e&&("object"==t||"function"==t)}var NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(e){if("number"==typeof e)return e;if(isSymbol(e))return NAN;if("string"!=typeof(e=isObject(e)?isObject(t="function"==typeof e.valueOf?e.valueOf():e)?t+"":t:e))return 0===e?e:+e;e=baseTrim(e);var t=reIsBinary.test(e);return t||reIsOctal.test(e)?freeParseInt(e.slice(2),t?2:8):reIsBadHex.test(e)?NAN:+e}var INFINITY$1=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(e){return e?(e=toNumber(e))===INFINITY$1||e===-INFINITY$1?(e<0?-1:1)*MAX_INTEGER:e==e?e:0:0===e?e:0}function toInteger(e){var e=toFinite(e),t=e%1;return e==e?t?e-t:e:0}function identity(e){return e}var asyncTag="[object AsyncFunction]",funcTag$1="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(e){return!!isObject(e)&&((e=baseGetTag(e))==funcTag$1||e==genTag||e==asyncTag||e==proxyTag)}var coreJsData=root["__core-js_shared__"],maskSrcKey=function(){var e=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource(e){if(null!=e){try{return funcToString$2.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$c=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$a=objectProto$c.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$a).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){return!(!isObject(e)||isMasked(e))&&(isFunction(e)?reIsNative:reIsHostCtor).test(toSource(e))}function getValue(e,t){return null==e?void 0:e[t]}function getNative(e,t){e=getValue(e,t);return baseIsNative(e)?e:void 0}var WeakMap=getNative(root,"WeakMap"),WeakMap$1=WeakMap,objectCreate=Object.create,baseCreate=function(){function t(){}return function(e){if(!isObject(e))return{};if(objectCreate)return objectCreate(e);t.prototype=e;e=new t;return t.prototype=void 0,e}}();function apply(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function copyArray(e,t){var r=-1,n=e.length;for(t=t||Array(n);++r<n;)t[r]=e[r];return t}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(r){var n=0,a=0;return function(){var e=nativeNow(),t=HOT_SPAN-(e-a);if(a=e,0<t){if(++n>=HOT_COUNT)return arguments[0]}else n=0;return r.apply(void 0,arguments)}}function constant(e){return function(){return e}}var defineProperty=function(){try{var e=getNative(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),baseSetToString=defineProperty?function(e,t){return defineProperty(e,"toString",{configurable:!0,enumerable:!1,value:constant(t),writable:!0})}:identity,baseSetToString$1=baseSetToString,setToString=shortOut(baseSetToString),MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var r=_typeof(e);return!!(t=null==t?MAX_SAFE_INTEGER$1:t)&&("number"==r||"symbol"!=r&&reIsUint.test(e))&&-1<e&&e%1==0&&e<t}function baseAssignValue(e,t,r){"__proto__"==t&&defineProperty?defineProperty(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function eq(e,t){return e===t||e!=e&&t!=t}var objectProto$b=Object.prototype,hasOwnProperty$9=objectProto$b.hasOwnProperty;function assignValue(e,t,r){var n=e[t];hasOwnProperty$9.call(e,t)&&eq(n,r)&&(void 0!==r||t in e)||baseAssignValue(e,t,r)}function copyObject(e,t,r,n){for(var a=!r,o=(r=r||{},-1),i=t.length;++o<i;){var s=t[o],c=n?n(r[s],e[s],s,r,e):void 0;(a?baseAssignValue:assignValue)(r,s,c=void 0===c?e[s]:c)}return r}var nativeMax$1=Math.max;function overRest(o,i,s){return i=nativeMax$1(void 0===i?o.length-1:i,0),function(){for(var e=arguments,t=-1,r=nativeMax$1(e.length-i,0),n=Array(r);++t<r;)n[t]=e[i+t];for(var t=-1,a=Array(i+1);++t<i;)a[t]=e[t];return a[i]=s(n),apply(o,this,a)}}function baseRest(e,t){return setToString(overRest(e,t,identity),e+"")}var MAX_SAFE_INTEGER=9007199254740991;function isLength(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=MAX_SAFE_INTEGER}function isArrayLike(e){return null!=e&&isLength(e.length)&&!isFunction(e)}function isIterateeCall(e,t,r){var n;return!!isObject(r)&&!!("number"==(n=_typeof(t))?isArrayLike(r)&&isIndex(t,r.length):"string"==n&&t in r)&&eq(r[t],e)}function createAssigner(s){return baseRest(function(e,t){var r=-1,n=t.length,a=1<n?t[n-1]:void 0,o=2<n?t[2]:void 0,a=3<s.length&&"function"==typeof a?(n--,a):void 0;for(o&&isIterateeCall(t[0],t[1],o)&&(a=n<3?void 0:a,n=1),e=Object(e);++r<n;){var i=t[r];i&&s(e,i,r,a)}return e})}var objectProto$a=Object.prototype;function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$a)}function baseTimes(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var argsTag$2="[object Arguments]";function baseIsArguments(e){return isObjectLike(e)&&baseGetTag(e)==argsTag$2}var objectProto$9=Object.prototype,hasOwnProperty$8=objectProto$9.hasOwnProperty,propertyIsEnumerable$1=objectProto$9.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike(e)&&hasOwnProperty$8.call(e,"callee")&&!propertyIsEnumerable$1.call(e,"callee")};function stubFalse(){return!1}var freeExports$2="object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&"object"==("undefined"==typeof module?"undefined":_typeof(module))&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$1=moduleExports$2?root.Buffer:void 0,nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:void 0,isBuffer=nativeIsBuffer||stubFalse,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",mapTag$2="[object Map]",numberTag$1="[object Number]",objectTag$3="[object Object]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$2="[object String]",weakMapTag$1="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(e){return isObjectLike(e)&&isLength(e.length)&&!!typedArrayTags[baseGetTag(e)]}function baseUnary(t){return function(e){return t(e)}}typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag$1]=typedArrayTags[arrayTag$1]=typedArrayTags[arrayBufferTag$1]=typedArrayTags[boolTag$1]=typedArrayTags[dataViewTag$2]=typedArrayTags[dateTag$1]=typedArrayTags[errorTag$1]=typedArrayTags[funcTag]=typedArrayTags[mapTag$2]=typedArrayTags[numberTag$1]=typedArrayTags[objectTag$3]=typedArrayTags[regexpTag$1]=typedArrayTags[setTag$2]=typedArrayTags[stringTag$2]=typedArrayTags[weakMapTag$1]=!1;var freeExports$1="object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&"object"==("undefined"==typeof module?"undefined":_typeof(module))&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal.process,nodeUtil=function(){try{var e=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return e?e:freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,objectProto$8=Object.prototype,hasOwnProperty$7=objectProto$8.hasOwnProperty;function arrayLikeKeys(e,t){var r,n=isArray(e),a=!n&&isArguments(e),o=!n&&!a&&isBuffer(e),i=!n&&!a&&!o&&isTypedArray(e),s=n||a||o||i,c=s?baseTimes(e.length,String):[],u=c.length;for(r in e)!t&&!hasOwnProperty$7.call(e,r)||s&&("length"==r||o&&("offset"==r||"parent"==r)||i&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||isIndex(r,u))||c.push(r);return c}function overArg(t,r){return function(e){return t(r(e))}}var nativeKeys=overArg(Object.keys,Object),objectProto$7=Object.prototype,hasOwnProperty$6=objectProto$7.hasOwnProperty;function baseKeys(e){if(!isPrototype(e))return nativeKeys(e);var t,r=[];for(t in Object(e))hasOwnProperty$6.call(e,t)&&"constructor"!=t&&r.push(t);return r}function keys(e){return(isArrayLike(e)?arrayLikeKeys:baseKeys)(e)}function nativeKeysIn(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}var objectProto$6=Object.prototype,hasOwnProperty$5=objectProto$6.hasOwnProperty;function baseKeysIn(e){if(!isObject(e))return nativeKeysIn(e);var t,r=isPrototype(e),n=[];for(t in e)("constructor"!=t||!r&&hasOwnProperty$5.call(e,t))&&n.push(t);return n}function keysIn(e){return isArrayLike(e)?arrayLikeKeys(e,!0):baseKeysIn(e)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(e,t){var r;return!isArray(e)&&(!("number"!=(r=_typeof(e))&&"symbol"!=r&&"boolean"!=r&&null!=e&&!isSymbol(e))||reIsPlainProp.test(e)||!reIsDeepProp.test(e)||null!=t&&e in Object(t))}var nativeCreate=getNative(Object,"create");function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}function hashDelete(e){e=this.has(e)&&delete this.__data__[e];return this.size-=e?1:0,e}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$5=Object.prototype,hasOwnProperty$4=objectProto$5.hasOwnProperty;function hashGet(e){var t,r=this.__data__;return nativeCreate?(t=r[e])===HASH_UNDEFINED$2?void 0:t:hasOwnProperty$4.call(r,e)?r[e]:void 0}var objectProto$4=Object.prototype,hasOwnProperty$3=objectProto$4.hasOwnProperty;function hashHas(e){var t=this.__data__;return nativeCreate?void 0!==t[e]:hasOwnProperty$3.call(t,e)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=nativeCreate&&void 0===t?HASH_UNDEFINED$1:t,this}function Hash(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(e,t){for(var r=e.length;r--;)if(eq(e[r][0],t))return r;return-1}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet;var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var t=this.__data__,e=assocIndexOf(t,e);return!(e<0||(e==t.length-1?t.pop():splice.call(t,e,1),--this.size,0))}function listCacheGet(e){var t=this.__data__,e=assocIndexOf(t,e);return e<0?void 0:t[e][1]}function listCacheHas(e){return-1<assocIndexOf(this.__data__,e)}function listCacheSet(e,t){var r=this.__data__,n=assocIndexOf(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function ListCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet;var Map=getNative(root,"Map");function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}}function isKeyable(e){var t=_typeof(e);return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function getMapData(e,t){e=e.__data__;return isKeyable(t)?e["string"==typeof t?"string":"hash"]:e.map}function mapCacheDelete(e){e=getMapData(this,e).delete(e);return this.size-=e?1:0,e}function mapCacheGet(e){return getMapData(this,e).get(e)}function mapCacheHas(e){return getMapData(this,e).has(e)}function mapCacheSet(e,t){var r=getMapData(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function MapCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT="Expected a function";function memoize(n,a){if("function"!=typeof n||null!=a&&"function"!=typeof a)throw new TypeError(FUNC_ERROR_TEXT);function o(){var e=arguments,t=a?a.apply(this,e):e[0],r=o.cache;return r.has(t)?r.get(t):(e=n.apply(this,e),o.cache=r.set(t,e)||r,e)}return o.cache=new(memoize.Cache||MapCache),o}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var e=memoize(e,function(e){return t.size===MAX_MEMOIZE_SIZE&&t.clear(),e}),t=e.cache;return e}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(e){var a=[];return 46===e.charCodeAt(0)&&a.push(""),e.replace(rePropName,function(e,t,r,n){a.push(r?n.replace(reEscapeChar,"$1"):t||e)}),a});function toString(e){return null==e?"":baseToString(e)}function castPath(e,t){return isArray(e)?e:isKey(e,t)?[e]:stringToPath(toString(e))}var INFINITY=1/0;function toKey(e){var t;return"string"==typeof e||isSymbol(e)?e:"0"==(t=e+"")&&1/e==-INFINITY?"-0":t}function baseGet(e,t){for(var r=0,n=(t=castPath(t,e)).length;null!=e&&r<n;)e=e[toKey(t[r++])];return r&&r==n?e:void 0}function get(e,t,r){e=null==e?void 0:baseGet(e,t);return void 0===e?r:e}function arrayPush(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var spreadableSymbol=_Symbol?_Symbol.isConcatSpreadable:void 0;function isFlattenable(e){return isArray(e)||isArguments(e)||!!(spreadableSymbol&&e&&e[spreadableSymbol])}function baseFlatten(e,t,r,n,a){var o=-1,i=e.length;for(r=r||isFlattenable,a=a||[];++o<i;){var s=e[o];0<t&&r(s)?1<t?baseFlatten(s,t-1,r,n,a):arrayPush(a,s):n||(a[a.length]=s)}return a}var getPrototype=overArg(Object.getPrototypeOf,Object),objectTag$2="[object Object]",funcProto=Function.prototype,objectProto$3=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$2=objectProto$3.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject(e){return!(!isObjectLike(e)||baseGetTag(e)!=objectTag$2)&&(null===(e=getPrototype(e))||"function"==typeof(e=hasOwnProperty$2.call(e,"constructor")&&e.constructor)&&e instanceof e&&funcToString.call(e)==objectCtorString)}function baseSlice(e,t,r){for(var n=-1,a=e.length,o=((r=a<r?a:r)<0&&(r+=a),a=r<(t=t<0?a<-t?0:a+t:t)?0:r-t>>>0,t>>>=0,Array(a));++n<a;)o[n]=e[n+t];return o}var nativeCeil=Math.ceil,nativeMax=Math.max;function chunk(e,t,r){t=(r?isIterateeCall(e,t,r):void 0===t)?1:nativeMax(toInteger(t),0);var n=null==e?0:e.length;if(!n||t<1)return[];for(var a=0,o=0,i=Array(nativeCeil(n/t));a<n;)i[o++]=baseSlice(e,a,a+=t);return i}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(e){var t=this.__data__,e=t.delete(e);return this.size=t.size,e}function stackGet(e){return this.__data__.get(e)}function stackHas(e){return this.__data__.has(e)}var LARGE_ARRAY_SIZE=200;function stackSet(e,t){var r=this.__data__;if(r instanceof ListCache){var n=r.__data__;if(!Map||n.length<LARGE_ARRAY_SIZE-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new MapCache(n)}return r.set(e,t),this.size=r.size,this}function Stack(e){e=this.__data__=new ListCache(e);this.size=e.size}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;var freeExports="object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==("undefined"==typeof module?"undefined":_typeof(module))&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer=moduleExports?root.Buffer:void 0,allocUnsafe=Buffer?Buffer.allocUnsafe:void 0;function cloneBuffer(e,t){return t?e.slice():(t=e.length,t=allocUnsafe?allocUnsafe(t):new e.constructor(t),e.copy(t),t)}function arrayFilter(e,t){for(var r=-1,n=null==e?0:e.length,a=0,o=[];++r<n;){var i=e[r];t(i,r,e)&&(o[a++]=i)}return o}function stubArray(){return[]}var objectProto$2=Object.prototype,propertyIsEnumerable=objectProto$2.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(t){return null==t?[]:(t=Object(t),arrayFilter(nativeGetSymbols(t),function(e){return propertyIsEnumerable.call(t,e)}))}:stubArray,getSymbols$1=getSymbols;function baseGetAllKeys(e,t,r){t=t(e);return isArray(e)?t:arrayPush(t,r(e))}function getAllKeys(e){return baseGetAllKeys(e,keys,getSymbols$1)}var DataView=getNative(root,"DataView"),DataView$1=DataView,Promise$1=getNative(root,"Promise"),Promise$2=Promise$1,Set=getNative(root,"Set"),Set$1=Set,mapTag$1="[object Map]",objectTag$1="[object Object]",promiseTag="[object Promise]",setTag$1="[object Set]",weakMapTag="[object WeakMap]",dataViewTag$1="[object DataView]",dataViewCtorString=toSource(DataView$1),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise$2),setCtorString=toSource(Set$1),weakMapCtorString=toSource(WeakMap$1),getTag=baseGetTag,getTag$1=getTag=DataView$1&&getTag(new DataView$1(new ArrayBuffer(1)))!=dataViewTag$1||Map&&getTag(new Map)!=mapTag$1||Promise$2&&getTag(Promise$2.resolve())!=promiseTag||Set$1&&getTag(new Set$1)!=setTag$1||WeakMap$1&&getTag(new WeakMap$1)!=weakMapTag?function(e){var t=baseGetTag(e),e=t==objectTag$1?e.constructor:void 0,e=e?toSource(e):"";if(e)switch(e){case dataViewCtorString:return dataViewTag$1;case mapCtorString:return mapTag$1;case promiseCtorString:return promiseTag;case setCtorString:return setTag$1;case weakMapCtorString:return weakMapTag}return t}:getTag,Uint8Array=root.Uint8Array;function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t}function cloneTypedArray(e,t){t=t?cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}function initCloneObject(e){return"function"!=typeof e.constructor||isPrototype(e)?{}:baseCreate(getPrototype(e))}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(e){return this.__data__.set(e,HASH_UNDEFINED),this}function setCacheHas(e){return this.__data__.has(e)}function SetCache(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new MapCache;++t<r;)this.add(e[t])}function arraySome(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function cacheHas(e,t){return e.has(t)}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas;var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(e,t,r,n,a,o){var i=r&COMPARE_PARTIAL_FLAG$5,s=e.length,c=t.length;if(s!=c&&!(i&&s<c))return!1;var c=o.get(e),u=o.get(t);if(c&&u)return c==t&&u==e;var l=-1,f=!0,y=r&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(o.set(e,t),o.set(t,e);++l<s;){var p,d=e[l],g=t[l];if(void 0!==(p=n?i?n(g,d,l,t,e,o):n(d,g,l,e,t,o):p)){if(p)continue;f=!1;break}if(y){if(!arraySome(t,function(e,t){if(!cacheHas(y,t)&&(d===e||a(d,e,r,n,o)))return y.push(t)})){f=!1;break}}else if(d!==g&&!a(d,g,r,n,o)){f=!1;break}}return o.delete(e),o.delete(t),f}function mapToArray(e){var r=-1,n=Array(e.size);return e.forEach(function(e,t){n[++r]=[t,e]}),n}function setToArray(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag$1="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=_Symbol?_Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(e,t,r,n,a,o,i){switch(r){case dataViewTag:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case arrayBufferTag:return e.byteLength==t.byteLength&&o(new Uint8Array(e),new Uint8Array(t))?!0:!1;case boolTag:case dateTag:case numberTag:return eq(+e,+t);case errorTag:return e.name==t.name&&e.message==t.message;case regexpTag:case stringTag$1:return e==t+"";case mapTag:var s=mapToArray;case setTag:s=s||setToArray;if(e.size!=t.size&&!(n&COMPARE_PARTIAL_FLAG$4))return!1;var c=i.get(e);if(c)return c==t;n|=COMPARE_UNORDERED_FLAG$2,i.set(e,t);c=equalArrays(s(e),s(t),n,a,o,i);return i.delete(e),c;case symbolTag:if(symbolValueOf)return symbolValueOf.call(e)==symbolValueOf.call(t)}return!1}var COMPARE_PARTIAL_FLAG$3=1,objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty;function equalObjects(e,t,r,n,a,o){var i=r&COMPARE_PARTIAL_FLAG$3,s=getAllKeys(e),c=s.length;if(c!=getAllKeys(t).length&&!i)return!1;for(var u=c;u--;){var l=s[u];if(!(i?l in t:hasOwnProperty$1.call(t,l)))return!1}var f=o.get(e),y=o.get(t);if(f&&y)return f==t&&y==e;for(var p=!0,d=(o.set(e,t),o.set(t,e),i);++u<c;){var g,b=e[l=s[u]],h=t[l];if(!(void 0===(g=n?i?n(h,b,l,t,e,o):n(b,h,l,e,t,o):g)?b===h||a(b,h,r,n,o):g)){p=!1;break}d=d||"constructor"==l}return p&&!d&&(f=e.constructor)!=(y=t.constructor)&&"constructor"in e&&"constructor"in t&&!("function"==typeof f&&f instanceof f&&"function"==typeof y&&y instanceof y)&&(p=!1),o.delete(e),o.delete(t),p}var COMPARE_PARTIAL_FLAG$2=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;function baseIsEqualDeep(e,t,r,n,a,o){var i=isArray(e),s=isArray(t),c=i?arrayTag:getTag$1(e),s=s?arrayTag:getTag$1(t),u=(c=c==argsTag?objectTag:c)==objectTag,l=(s=s==argsTag?objectTag:s)==objectTag,s=c==s;if(s&&isBuffer(e)){if(!isBuffer(t))return!1;u=!(i=!0)}if(s&&!u)return o=o||new Stack,i||isTypedArray(e)?equalArrays(e,t,r,n,a,o):equalByTag(e,t,c,r,n,a,o);if(!(r&COMPARE_PARTIAL_FLAG$2)){i=u&&hasOwnProperty.call(e,"__wrapped__"),c=l&&hasOwnProperty.call(t,"__wrapped__");if(i||c)return a(i?e.value():e,c?t.value():t,r,n,o=o||new Stack)}return s&&equalObjects(e,t,r,n,a,o=o||new Stack)}function baseIsEqual(e,t,r,n,a){return e===t||(null==e||null==t||!isObjectLike(e)&&!isObjectLike(t)?e!=e&&t!=t:baseIsEqualDeep(e,t,r,n,baseIsEqual,a))}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(e,t,r,n){var a=r.length,o=a,i=!n;if(null==e)return!o;for(e=Object(e);a--;){var s=r[a];if(i&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++a<o;){var c=(s=r[a])[0],u=e[c],l=s[1];if(i&&s[2]){if(void 0===u&&!(c in e))return!1}else{var f,y=new Stack;if(!(void 0===(f=n?n(u,l,c,e,t,y):f)?baseIsEqual(l,u,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,n,y):f))return!1}}return!0}function isStrictComparable(e){return e==e&&!isObject(e)}function getMatchData(e){for(var t=keys(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,isStrictComparable(a)]}return t}function matchesStrictComparable(t,r){return function(e){return null!=e&&e[t]===r&&(void 0!==r||t in Object(e))}}function baseMatches(t){var r=getMatchData(t);return 1==r.length&&r[0][2]?matchesStrictComparable(r[0][0],r[0][1]):function(e){return e===t||baseIsMatch(e,t,r)}}function baseHasIn(e,t){return null!=e&&t in Object(e)}function hasPath(e,t,r){for(var n=-1,a=(t=castPath(t,e)).length,o=!1;++n<a;){var i=toKey(t[n]);if(!(o=null!=e&&r(e,i)))break;e=e[i]}return o||++n!=a?o:!!(a=null==e?0:e.length)&&isLength(a)&&isIndex(i,a)&&(isArray(e)||isArguments(e))}function hasIn(e,t){return null!=e&&hasPath(e,t,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(r,n){return isKey(r)&&isStrictComparable(n)?matchesStrictComparable(toKey(r),n):function(e){var t=get(e,r);return void 0===t&&t===n?hasIn(e,r):baseIsEqual(n,t,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(t){return function(e){return null==e?void 0:e[t]}}function basePropertyDeep(t){return function(e){return baseGet(e,t)}}function property(e){return isKey(e)?baseProperty(toKey(e)):basePropertyDeep(e)}function baseIteratee(e){return"function"==typeof e?e:null==e?identity:"object"==_typeof(e)?isArray(e)?baseMatchesProperty(e[0],e[1]):baseMatches(e):property(e)}function createBaseFor(c){return function(e,t,r){for(var n=-1,a=Object(e),o=r(e),i=o.length;i--;){var s=o[c?i:++n];if(!1===t(a[s],s,a))break}return e}}var baseFor=createBaseFor();function baseForOwn(e,t){return e&&baseFor(e,t,keys)}function createBaseEach(o,i){return function(e,t){if(null!=e){if(!isArrayLike(e))return o(e,t);for(var r=e.length,n=i?r:-1,a=Object(e);(i?n--:++n<r)&&!1!==t(a[n],n,a););}return e}}var baseEach=createBaseEach(baseForOwn);function assignMergeValue(e,t,r){(void 0===r||eq(e[t],r))&&(void 0!==r||t in e)||baseAssignValue(e,t,r)}function isArrayLikeObject(e){return isObjectLike(e)&&isArrayLike(e)}function safeGet(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function toPlainObject(e){return copyObject(e,keysIn(e))}function baseMergeDeep(e,t,r,n,a,o,i){var s,c,u,l=safeGet(e,r),f=safeGet(t,r),y=i.get(f);y||((t=void 0===(y=o?o(l,f,r+"",e,t,i):void 0))&&(c=!(s=isArray(f))&&isBuffer(f),u=!s&&!c&&isTypedArray(f),y=f,s||c||u?y=isArray(l)?l:isArrayLikeObject(l)?copyArray(l):c?cloneBuffer(f,!(t=!1)):u?cloneTypedArray(f,!(t=!1)):[]:isPlainObject(f)||isArguments(f)?isArguments(y=l)?y=toPlainObject(l):isObject(l)&&!isFunction(l)||(y=initCloneObject(f)):t=!1),t&&(i.set(f,y),a(y,f,n,o,i),i.delete(f))),assignMergeValue(e,r,y)}function baseMerge(n,a,o,i,s){n!==a&&baseFor(a,function(e,t){var r;s=s||new Stack,isObject(e)?baseMergeDeep(n,a,t,o,baseMerge,i,s):(r=i?i(safeGet(n,t),e,t+"",n,a,s):void 0,assignMergeValue(n,t,r=void 0===r?e:r))},keysIn)}function baseMap(e,n){var a=-1,o=isArrayLike(e)?Array(e.length):[];return baseEach(e,function(e,t,r){o[++a]=n(e,t,r)}),o}var stringTag="[object String]";function isString(e){return"string"==typeof e||!isArray(e)&&isObjectLike(e)&&baseGetTag(e)==stringTag}var merge=createAssigner(function(e,t,r){baseMerge(e,t,r)});function baseSortBy(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}function compareAscending(e,t){if(e!==t){var r=void 0!==e,n=null===e,a=e==e,o=isSymbol(e),i=void 0!==t,s=null===t,c=t==t,u=isSymbol(t);if(!s&&!u&&!o&&t<e||o&&i&&c&&!s&&!u||n&&i&&c||!r&&c||!a)return 1;if(!n&&!o&&!u&&e<t||u&&r&&a&&!n&&!o||s&&r&&a||!i&&a||!c)return-1}return 0}function compareMultiple(e,t,r){for(var n=-1,a=e.criteria,o=t.criteria,i=a.length,s=r.length;++n<i;){var c=compareAscending(a[n],o[n]);if(c)return s<=n?c:c*("desc"==r[n]?-1:1)}return e.index-t.index}function baseOrderBy(e,n,r){n=n.length?arrayMap(n,function(t){return isArray(t)?function(e){return baseGet(e,1===t.length?t[0]:t)}:t}):[identity];var a=-1;return n=arrayMap(n,baseUnary(baseIteratee)),baseSortBy(baseMap(e,function(t,e,r){return{criteria:arrayMap(n,function(e){return e(t)}),index:++a,value:t}}),function(e,t){return compareMultiple(e,t,r)})}var nativeFloor=Math.floor,nativeRandom$1=Math.random;function baseRandom(e,t){return e+nativeFloor(nativeRandom$1()*(t-e+1))}var freeParseFloat=parseFloat,nativeMin=Math.min,nativeRandom=Math.random;function _random(e,t,r){var n;return r&&"boolean"!=typeof r&&isIterateeCall(e,t,r)&&(t=r=void 0),void 0===r&&("boolean"==typeof t?(r=t,t=void 0):"boolean"==typeof e&&(r=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=toFinite(e),void 0===t?(t=e,e=0):t=toFinite(t)),t<e&&(n=e,e=t,t=n),r||e%1||t%1?(n=nativeRandom(),nativeMin(e+n*(t-e+freeParseFloat("1e-"+((n+"").length-1))),t)):baseRandom(e,t)}var sortBy=baseRest(function(e,t){var r;return null==e?[]:(1<(r=t.length)&&isIterateeCall(e,t[0],t[1])?t=[]:2<r&&isIterateeCall(t[0],t[1],t[2])&&(t=[t[0]]),baseOrderBy(e,baseFlatten(t,1),[]))}),fromBin=function(e){return parseInt(e,2)},fromBinToBase32=function(e){return parseInt(e,2).toString(32)},fromBase32ToBin=function(e){return parseInt(e,32).toString(2)},Base=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"charToBin",value:function(e){return fromBase32ToBin(e).padStart(5,"0")}},{key:"targetTypes",value:function(e){return((1<arguments.length&&void 0!==arguments[1]?arguments[1]:null)||["sensor","neuron","action"])[e]||"neuron"}},{key:"getConfig",value:function(){var e={config:this.charToBin((0<arguments.length&&void 0!==arguments[0]?arguments[0]:"")[0])},t=_slicedToArray(chunk(e.config.split(""),4),2),r=t[0],t=_slicedToArray(t[1],1)[0],t=("0"===(e.type=t)?e.type="connection":"1"===t&&(e.type="bias"),"bias"===e.type?r.pop():void 0);return e.data=fromBin(r.join("")),"1"===t&&(e.data*=-1),e}},{key:"getTarget",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,e=e.split("").map(function(e){return t.charToBin(e)}),e=_slicedToArray(chunk(e=e.join("").split(""),e.length-r),2),r=e[0],e=e[1];return{id:fromBin(r.join("")),type:this.targetTypes(fromBin(e.join("")),n)}}},{key:"fromString",value:function(){var e={encoded:0<arguments.length&&void 0!==arguments[0]?arguments[0]:""};return"bias"===(e=merge(e,this.getConfig(e.encoded[0]))).type?(e.encoded=e.encoded.padEnd(3,"0"),e.target=this.getTarget(e.encoded[1]+e.encoded[2],2)):"connection"===e.type&&(e.encoded=e.encoded.padEnd(5,"0"),e.source=this.getTarget(e.encoded[1]+e.encoded[2],1,["sensor","neuron"]),e.target=this.getTarget(e.encoded[3]+e.encoded[4],1,["neuron","action"])),delete e.config,e}},{key:"toString",value:function(e){var t="";return"bias"===e.type?(t+=Math.abs(e.data).toString(2).padStart(3,"0"),0<=e.data?t+="0":t+="1",t=(t+="1")+e.target.id.toString(2).padStart(8,"0"),"sensor"===e.target.type?t+="00":"neuron"!==e.target.type&&"action"===e.target.type?t+="10":t+="01"):"connection"===e.type&&(t=(t=t+Math.abs(e.data).toString(2).padStart(4,"0")+"0")+e.source.id.toString(2).padStart(9,"0"),"sensor"===e.source.type?t+="0":(e.source.type,t+="1"),t+=e.target.id.toString(2).padStart(9,"0"),"neuron"!==e.target.type&&"action"===e.target.type?t+="1":t+="0"),chunk(t,5).map(function(e){return fromBinToBase32(e.join(""))}).join("").toUpperCase()}},{key:"random",value:function(){return _random(0,10)<5?{type:"bias",data:_random(0,4),target:{id:_random(1,100),type:["sensor","neuron","action"][_random(0,2)]}}:{type:"connection",data:_random(0,4),source:{type:["sensor","neuron","action"][_random(0,2)],id:_random(1,100)},target:{type:["sensor","neuron","action"][_random(0,2)],id:_random(1,100)}}}},{key:"randomString",value:function(){return this.toString(this.random())}},{key:"randomWith",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.neurons,r=void 0===r?1:r,n=t.sensors,n=void 0===n?1:n,t=t.actions,t=void 0===t?1:t;return _random(0,100)<25?(e=_random(-3,3),_random(0,100)<33?{type:"bias",data:e,target:{type:"sensor",id:_random(0,n-1)}}:_random(0,100)<50?{type:"bias",data:e,target:{type:"neuron",id:_random(0,r-1)}}:{type:"bias",data:e,target:{type:"sensor",id:_random(0,t-1)}}):(e=_random(0,4),_random(0,100)<50?{type:"connection",data:e,source:{type:"sensor",id:_random(0,n-1)},target:{type:"neuron",id:_random(0,r-1)}}:{type:"connection",data:e,source:{type:"neuron",id:_random(0,r-1)},target:{type:"action",id:_random(0,t-1)}})}}]),e}(),Genome=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"from",value:function(e){return isString(e)?this.fromString(e):isArray(e)?this.fromBases(e):e}},{key:"fromString",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t={encoded:(e||"").toUpperCase().trim(),bases:[]},r=e.split("");0<r.length;){var n=r.shift(),a=Base.fromString(n);"bias"===a.type?n=(n+=r.shift()||"")+(r.shift()||""):"connection"===a.type&&(n=(n=(n=(n+=r.shift()||"")+(r.shift()||""))+(r.shift()||""))+(r.shift()||"")),n=Base.fromString(n.trim()),t.bases.push(n)}return t}},{key:"fromBases",value:function(e){return{bases:e,encoded:e.map(function(e){return Base.toString(e)}).join("")}}},{key:"toString",value:function(e){return e.map(function(e){return Base.toString(e)}).join("")}},{key:"random",value:function(){var e=new Array(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1).fill(null).map(function(){return Base.random()});return{bases:e,encoded:e.map(function(e){return Base.toString(e)}).join("")}}},{key:"randomWith",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.neurons,n=void 0===r?1:r,r=t.sensors,a=void 0===r?1:r,r=t.actions,o=void 0===r?1:r,t=new Array(e).fill(null).map(function(){return Base.randomWith({neurons:n,sensors:a,actions:o})});return{bases:t,encoded:t.map(function(e){return Base.toString(e)}).join("")}}}]),e}();function dotProduct(e,n){return e.reduce(function(e,t,r){return e+t*n[r]},0)}var Vertex=function(){function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,r),this.name=e,this.metadata=_objectSpread({},t),this.in=[],this.inMap={},this.out=[],this.outMap={}}return _createClass(r,[{key:"addIn",value:function(e,t){this.inMap[e.name]?(this.inMap[e.name].weight+=t,this.in[this.inMap[e.name].index].weight+=t):this.inMap[e.name]={weight:t,index:this.in.push({vertex:e,weight:t})-1}}},{key:"addOut",value:function(e,t){this.outMap[e.name]?(this.outMap[e.name].weight+=t,this.out[this.outMap[e.name].index].weight+=t):this.outMap[e.name]={weight:t,index:this.out.push({vertex:e,weight:t})-1}}},{key:"neighbors",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return e?this.in.filter(e).concat(this.out.filter(e)):this.in.concat(this.out)}},{key:"toJSON",value:function(){return{name:this.name,metadata:this.metadata,in:this.in.map(function(e){return e.vertex.name}),out:this.out.map(function(e){return e.vertex.name})}}},{key:"toString",value:function(){return JSON.stringify(this.toJSON(),null,2)}},{key:"inputsTree",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(t[this.name])return[];var r,n=[],a=(t[this.name]=n.push({deph:e,vertex:this}),_createForOfIteratorHelper(this.in));try{for(a.s();!(r=a.n()).done;)var o=(o=r.value.vertex.inputsTree(e+1,t)).filter(function(e){return!t[e.name]}),n=n.concat(o)}catch(e){a.e(e)}finally{a.f()}return sortBy(n,["deph"])}},{key:"calculateInput",value:function(){var e,t=[],r=[],n=_createForOfIteratorHelper(this.in);try{for(n.s();!(e=n.n()).done;){var a=e.value,o=a.vertex,i=a.weight;t.push(o.metadata.lastTick||0),r.push(i)}}catch(e){n.e(e)}finally{n.f()}return dotProduct(t,r)}}]),r}();function sigmoid(){return 1/(1+Math.exp(-1*(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0)))}function relu(){return Math.max(0,0<arguments.length&&void 0!==arguments[0]?arguments[0]:0)}var Brain=function(){function o(e){var t=e.genome,r=e.sensors,r=void 0===r?[]:r,n=e.actions,n=void 0===n?[]:n,a=e.environment,a=void 0===a?{}:a,e=e.activationFunction,e=void 0===e?"relu":e;_classCallCheck(this,o),this.environment=a,this.genome=Genome.from(t),this.activationFunction="sigmoid"===e?sigmoid:relu,this.definitions={all:{},actions:{},neurons:{},sensors:{}},this.sensors=r.reduce(function(e,t,r){return t.name||(t.name="s#".concat(t.id||r)),e[t.name]=t,e},{}),this.actions=n.reduce(function(e,t,r){return t.name||(t.name="a#".concat(t.id||r)),e[t.name]=t,e},{}),this.tickOrder=[],this.setup()}return _createClass(o,[{key:"setup",value:function(){var e,n=this,t=_createForOfIteratorHelper(this.genome.bases);try{for(t.s();!(e=t.n()).done;){var r=e.value;"bias"===r.type?this.setupBias(r):"connection"===r.type&&this.setupConnection(r)}}catch(e){t.e(e)}finally{t.f()}this.tickOrder=this.defineTickOrder();for(var a=this.environment,o=this.activationFunction,i=0,s=Object.values(this.definitions.sensors);i<s.length;i++)!function(){var e,t=s[i],r=(r=(null==(e=n.sensors[t.name])?void 0:e.tick)||function(){return 0}).bind(a.me||n);t.tick=function(){var e=r(a)+(this.metadata.bias||0);return this.metadata.lastTick=e}}();for(var c=0,u=Object.values(this.definitions.neurons);c<u.length;c++)u[c].tick=function(){var e=this.calculateInput(),e=o(e+(this.metadata.bias||0));return this.metadata.lastTick=e};for(var l=0,f=Object.values(this.definitions.actions);l<f.length;l++)!function(){var e,t=f[l],r=(r=(null==(e=n.actions[t.name])?void 0:e.tick)||function(){return 0}).bind(a.me||n);t.tick=function(){var e=this.calculateInput(),e=o(e+(this.metadata.bias||0)),e=r(e,a);return this.metadata.lastTick=e}}()}},{key:"setupBias",value:function(e){var t=e.target,e=e.data;this.findOrCreateVertex({id:t.id,collection:t.type+"s",metadata:{bias:e||0,type:t.type}})}},{key:"setupConnection",value:function(e){var t=e.data,r=e.source,e=e.target,r=this.findOrCreateVertex({id:r.id,collection:r.type+"s",metadata:{type:r.type}}),e=this.findOrCreateVertex({id:e.id,collection:e.type+"s",metadata:{type:e.type}});e.addIn(r,t),r.addOut(e,t)}},{key:"findOrCreateVertex",value:function(e){var t=e.id,r=e.collection,e=e.metadata;return this.definitions[r][t]?(this.definitions[r][t].metadata.bias=this.definitions[r][t].metadata.bias+(e.bias||0),this.definitions[r][t]):(e=new Vertex("".concat(r[0],"#").concat(t),_objectSpread(_objectSpread({bias:0},e),{},{id:t})),this.definitions[r][t]=e,this.definitions.all[e.name]=e)}},{key:"defineTickOrder",value:function(){var e,t=[],r=_createForOfIteratorHelper(Object.values(this.definitions.actions).filter(function(e){return 0<e.in.length}));try{for(r.s();!(e=r.n()).done;){var n=e.value,t=t.concat(n.inputsTree());t=sortBy(t,["deph"]).reverse()}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"tick",value:function(){var e,t={},r={sensor:[],neuron:[],action:[]},n=_createForOfIteratorHelper(this.tickOrder);try{for(n.s();!(e=n.n()).done;){var a=e.value.vertex;r[a.metadata.type].push(a)}}catch(e){n.e(e)}finally{n.f()}var o,i=_createForOfIteratorHelper(r.sensor);try{for(i.s();!(o=i.n()).done;){var s=o.value;t[s.name]||(t[s.name]=s.tick())}}catch(e){i.e(e)}finally{i.f()}var c,u=_createForOfIteratorHelper(r.neuron);try{for(u.s();!(c=u.n()).done;){var l=c.value;t[l.name]||(t[l.name]=l.tick())}}catch(e){u.e(e)}finally{u.f()}var f,y=[],p=_createForOfIteratorHelper(r.action);try{for(p.s();!(f=p.n()).done;){var d=f.value;t[d.name]||y.push({input:d.calculateInput(),vertex:d})}}catch(e){p.e(e)}finally{p.f()}var g=sortBy(y,["input"]).pop().vertex;return t[g.name]=g.tick(),t}}]),o}(),Reproduction=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"genomeMutate",value:function(e){var t,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.001;return isString(e)?(t=e.split("").map(function(e){return Math.random()>r?e:_random(0,31).toString(32).toUpperCase()}).join(""),Genome.fromString(t)):(t=e.bases.map(function(e){return Math.random()>r?e:Base.random()}),Genome.fromBases(t))}}]),e}(),Individual=function(){function l(e){var t=this,r=e.genome,r=void 0===r?null:r,n=e.sensors,a=void 0===n?[]:n,n=e.actions,o=void 0===n?[]:n,n=e.environment,n=void 0===n?{}:n,i=e.childrenClass,s=void 0===i?l:i,i=e.extraParams,c=void 0===i?{}:i,u=(_classCallCheck(this,l),this.genome=Genome.from(r),merge({me:this},n));this.brain=new Brain({sensors:a,actions:o,genome:this.genome,environment:u}),this.reproduce={asexual:{fission:function(){return new s(_objectSpread({sensors:a,actions:o,environment:u,genome:Reproduction.genomeMutate(t.genome,0<arguments.length&&void 0!==arguments[0]?arguments[0]:.001)},c))}}}}return _createClass(l,[{key:"tick",value:function(){return this.brain.tick()}}]),l}();exports.Base=Base,exports.Brain=Brain,exports.Genome=Genome,exports.Individual=Individual,exports.Reproduction=Reproduction,exports.Vertex=Vertex;
